CREATE TABLE CUSTOMER(
	CUSTOMER_ID NUMBER(2),
	FIRST_NAME VARCHAR2(10),
	LAST_NAME VARCHAR2(10),
	GENDER CHAR(1),
	PHONE CHAR(10),
	EMAIL VARCHAR2(20),
	CONSTRAINT UQ_CUSTOMER_EMAIL UNIQUE(EMAIL),
	CONSTRAINT UQ_CUSTOMER_PHONE UNIQUE(PHONE),
	CONSTRAINT PK_CUSTOMER PRIMARY KEY(CUSTOMER_ID)
)
/

INSERT INTO CUSTOMER
VALUES(11, 'ARPAN', 'GHOSH', 'M', '7596847274', 'a@gmail.com')
/
INSERT INTO CUSTOMER
VALUES(12, 'ANKITA', 'DE', 'F', '7596847275', 'b@gmail.com')
/
INSERT INTO CUSTOMER
VALUES(13, 'DIPIKA', 'MONDOL', 'F', '7596847276', 'c@gmail.com')
/

CREATE TABLE ADDRESS(
	ADDRESS_ID NUMBER(2),
	STATE VARCHAR2(20),
	CITY VARCHAR2(20),
	ADDRESS_LINE VARCHAR2(20),
	LANDMARK VARCHAR2(20),
	PIN_CODE CHAR(6)
)
/

ALTER TABLE ADDRESS MODIFY(
	ADDRESS_ID NUMBER(2) CONSTRAINT PK_ADDRESS PRIMARY KEY,
	PIN_CODE CHAR(6) CONSTRAINT NN_ADDRESS_PIN NOT NULL,
	CITY VARCHAR2(20) CONSTRAINT NN_ADDRESS_CITY NOT NULL,
	STATE VARCHAR2(20) CONSTRAINT NN_ADDRESS_STATE NOT NULL,
	ADDRESS_LINE VARCHAR2(40) CONSTRAINT NN_ADDRESS_LINE NOT NULL
)
/

INSERT INTO ADDRESS(ADDRESS_ID, STATE, CITY, ADDRESS_LINE, PIN_CODE)
VALUES(41, 'WB', 'KOLKATA', '14/A, A.J.C.Bose Road', '700020')
/
INSERT INTO ADDRESS(ADDRESS_ID, STATE, CITY, ADDRESS_LINE, PIN_CODE)
VALUES(42, 'CHENNAI', 'ALANDUR', '72/D, K.K. Nagar', '600078')
/
INSERT INTO ADDRESS(ADDRESS_ID, STATE, CITY, ADDRESS_LINE, PIN_CODE)
VALUES(43, 'WB', 'KOLKATA', '9/C, Belgachia Road', '700037')
/

CREATE TABLE CUSTOMER_ADDRESS(
	CUSTOMER_ID NUMBER(2),
	ADDRESS_ID NUMBER(2),
	CONSTRAINT FK_CA_CID FOREIGN KEY(CUSTOMER_ID)
	REFERENCES CUSTOMER(CUSTOMER_ID) ON DELETE CASCADE,
	CONSTRAINT FK_CA_AID FOREIGN KEY(ADDRESS_ID)
	REFERENCES ADDRESS(ADDRESS_ID) ON DELETE SET NULL
)
/

INSERT INTO CUSTOMER_ADDRESS
VALUES(11, 41)
/
INSERT INTO CUSTOMER_ADDRESS
VALUES(12, 42)
/
INSERT INTO CUSTOMER_ADDRESS
VALUES(13, 43)
/

CREATE TABLE BOOK(
	BOOK_ID NUMBER(2) CONSTRAINT PK_BOOK PRIMARY KEY,
	BOOK_NAME VARCHAR2(20) CONSTRAINT NN_BOOK_NAME NOT NULL,
	PAGE_COUNT NUMBER(5),
	STOCK NUMBER(7),
	PRICE NUMBER(9, 2) CONSTRAINT NN_BOOK_PRICE NOT NULL
)
/

INSERT INTO BOOK
VALUES(21, 'JAVA-A', 1200, 120, 850)
/
INSERT INTO BOOK
VALUES(22, 'CPP-A', 800, 75, 670)
/
INSERT INTO BOOK
VALUES(23, 'PYTHON-A', 1300, 195, 1250)
/
INSERT INTO BOOK
VALUES(24, 'JAVA-B', 1000, 90, 780)
/
INSERT INTO BOOK
VALUES(25, 'ORACLE-A', 950, 50, 990)
/

CREATE TABLE AUTHOR(
	AUTHOR_ID NUMBER(2),
	AUTHOR_NAME VARCHAR2(20) CONSTRAINT NN_AUTHOR_NAME NOT NULL,
	AUTHOR_EMAIL VARCHAR2(20) CONSTRAINT NN_AUTHOR_EMAIL NOT NULL
)
/

ALTER TABLE AUTHOR ADD(
	CONSTRAINT PK_AUTHOR PRIMARY KEY(AUTHOR_ID),
	CONSTRAINT UQ_AUTHOR_NAME UNIQUE(AUTHOR_NAME),
	CONSTRAINT UQ_AUTHOR_EMAIL UNIQUE(AUTHOR_EMAIL)
)
/

INSERT INTO AUTHOR
VALUES(31, 'AMITAVA', 'd@gmail.com')
/
INSERT INTO AUTHOR
VALUES(32, 'ANIKET', 'e@gmail.com')
/

CREATE TABLE BOOK_AUTHOR(
	BOOK_ID NUMBER(2),
	AUTHOR_ID NUMBER(2),
	CONSTRAINT FK_BA_BID FOREIGN KEY(BOOK_ID)
	REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE,
	CONSTRAINT FK_BA_AID FOREIGN KEY(AUTHOR_ID)
	REFERENCES AUTHOR(AUTHOR_ID) ON DELETE SET NULL
)
/

INSERT INTO BOOK_AUTHOR
VALUES(21, 31)
/
INSERT INTO BOOK_AUTHOR
VALUES(22, 31)
/
INSERT INTO BOOK_AUTHOR
VALUES(23, 31)
/
INSERT INTO BOOK_AUTHOR
VALUES(24, 32)
/
INSERT INTO BOOK_AUTHOR
VALUES(25, 31)
/
INSERT INTO BOOK_AUTHOR
VALUES(25, 32)
/

CREATE TABLE ORDERS(
	ORDER_ID NUMBER(2),
	CUSTOMER_ID NUMBER(2),
	ADDRESS_ID NUMBER(2),
	ORDER_DATE DATE DEFAULT SYSDATE,
	SHIPPED_DATE DATE DEFAULT SYSDATE + 2,
	DELIVERY_DATE DATE DEFAULT SYSDATE + 7,
	STATUS CHAR(1) DEFAULT 'F'
)
/

ALTER TABLE ORDERS ADD(
	CONSTRAINT PK_ORDERS PRIMARY KEY(ORDER_ID),
	CONSTRAINT FK_ORDERS_CID FOREIGN KEY(CUSTOMER_ID)
	REFERENCES CUSTOMER(CUSTOMER_ID) ON DELETE CASCADE,
	CONSTRAINT FK_ORDERS_AID FOREIGN KEY(ADDRESS_ID)
	REFERENCES ADDRESS(ADDRESS_ID) ON DELETE SET NULL
)
/

INSERT INTO ORDERS(ORDER_ID, CUSTOMER_ID, ADDRESS_ID)
VALUES(51, 12, 42)
/
INSERT INTO ORDERS(ORDER_ID, CUSTOMER_ID, ADDRESS_ID)
VALUES(52, 12, 42)
/
INSERT INTO ORDERS(ORDER_ID, CUSTOMER_ID, ADDRESS_ID)
VALUES(53, 11, 41)
/
INSERT INTO ORDERS(ORDER_ID, CUSTOMER_ID, ADDRESS_ID)
VALUES(54, 13, 43)
/
INSERT INTO ORDERS(ORDER_ID, CUSTOMER_ID, ADDRESS_ID)
VALUES(55, 11, 41)
/
INSERT INTO ORDERS(ORDER_ID, CUSTOMER_ID, ADDRESS_ID)
VALUES(56, 12, 42)
/

CREATE TABLE ORDERS_BOOK(
	ORDER_ID NUMBER(2),
	BOOK_ID NUMBER(2),
	QTY NUMBER(7),
	CONSTRAINT FK_OB_OID FOREIGN KEY(ORDER_ID)
	REFERENCES ORDERS(ORDER_ID) ON DELETE CASCADE,
	CONSTRAINT FK_OB_BID FOREIGN KEY(BOOK_ID)
	REFERENCES BOOK(BOOK_ID) ON DELETE SET NULL
)
/

INSERT INTO ORDERS_BOOK
VALUES(51, 21, 1)
/
INSERT INTO ORDERS_BOOK
VALUES(52, 22, 1)
/
INSERT INTO ORDERS_BOOK
VALUES(52, 23, 1)
/
INSERT INTO ORDERS_BOOK
VALUES(53, 25, 2)
/
INSERT INTO ORDERS_BOOK
VALUES(54, 24, 3)
/
INSERT INTO ORDERS_BOOK
VALUES(55, 21, 1)
/
INSERT INTO ORDERS_BOOK
VALUES(56, 21, 2)
/
INSERT INTO ORDERS_BOOK
VALUES(56, 23, 3)
/
